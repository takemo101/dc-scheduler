!function(e){"use strict";var n=e.plot.uiConstants.ZOOM_DISTANCE_MARGIN;function t(t,u){var d,p,h,l,v={zoomEnable:!1,prevDistance:null,prevTapTime:0,prevPanPosition:{x:0,y:0},prevTapPosition:{x:0,y:0}},x={prevTouchedAxis:"none",currentTouchedAxis:"none",touchedAxis:null,navigationConstraint:"unconstrained",initialState:null},g=u.pan.interactive&&"manual"===u.pan.touchMode,T="smartLock"===u.pan.touchMode,f=u.pan.interactive&&(T||"smart"===u.pan.touchMode);function A(e,n,a){x.touchedAxis=function(e,n,t,i){if("pinchstart"!==n.type)return"panstart"===n.type||"pinchend"===n.type?e.getTouchedAxis(n.detail.touches[0].pageX,n.detail.touches[0].pageY):i.touchedAxis;var a=e.getTouchedAxis(n.detail.touches[0].pageX,n.detail.touches[0].pageY),o=e.getTouchedAxis(n.detail.touches[1].pageX,n.detail.touches[1].pageY);if(a.length===o.length&&a.toString()===o.toString())return a}(t,e,0,x),i(x)?x.navigationConstraint="unconstrained":x.navigationConstraint="axisConstrained"}d={start:function(e){if(A(e,"pan",v),a(e,"pan",v,x),f){var n=s(e,"pan");x.initialState=t.navigationState(n.x,n.y)}},drag:function(e){if(A(e,"pan",v),f){var n=s(e,"pan");t.smartPan({x:x.initialState.startPageX-n.x,y:x.initialState.startPageY-n.y},x.initialState,x.touchedAxis,!1,T)}else g&&(t.pan({left:-c(e,"pan",v).x,top:-c(e,"pan",v).y,axes:x.touchedAxis}),r(e,"pan",v,x))},end:function(e){A(e,"pan",v),f&&t.smartPan.end(),function(e,n){return n.zoomEnable&&1===e.detail.touches.length}(e,v)&&updateprevPanPosition(e,"pan",v,x)}},p={start:function(e){l&&(clearTimeout(l),l=null),A(e,"pinch",v),function(e,n){n.prevDistance=o(e)}(e,v),a(e,"pinch",v,x)},drag:function(e){l||(l=setTimeout((function(){A(e,"pinch",v),t.pan({left:-c(e,"pinch",v).x,top:-c(e,"pinch",v).y,axes:x.touchedAxis}),r(e,"pinch",v,x);var i=o(e);(v.zoomEnable||Math.abs(i-v.prevDistance)>n)&&(!function(e,n,t,i){var a=e.offset(),r={left:0,top:0},c=o(n)/t.prevDistance,u=o(n);r.left=s(n,"pinch").x-a.left,r.top=s(n,"pinch").y-a.top,e.zoom({center:r,amount:c,axes:i.touchedAxis}),t.prevDistance=u}(t,e,v,x),v.zoomEnable=!0),l=null}),1e3/60))},end:function(e){l&&(clearTimeout(l),l=null),A(e,"pinch",v),v.prevDistance=null}},h={recenterPlot:function(n){n&&n.detail&&"touchstart"===n.detail.type&&function(n,t,a,o){if(function(e,n,t){var a=e.getTouchedAxis(n.detail.firstTouch.x,n.detail.firstTouch.y);void 0!==a[0]&&(t.prevTouchedAxis=a[0].direction);void 0!==(a=e.getTouchedAxis(n.detail.secondTouch.x,n.detail.secondTouch.y))[0]&&(t.touchedAxis=a,t.currentTouchedAxis=a[0].direction);i(t)&&(t.touchedAxis=null,t.prevTouchedAxis="none",t.currentTouchedAxis="none")}(n,t,o),"x"===o.currentTouchedAxis&&"x"===o.prevTouchedAxis||"y"===o.currentTouchedAxis&&"y"===o.prevTouchedAxis||"none"===o.currentTouchedAxis&&"none"===o.prevTouchedAxis){var r;n.recenter({axes:o.touchedAxis}),r=o.touchedAxis?new e.Event("re-center",{detail:{axisTouched:o.touchedAxis}}):new e.Event("re-center",{detail:t}),n.getPlaceholder().trigger(r)}}(t,n,0,x)}},!0!==u.pan.enableTouch&&!0!==u.zoom.enableTouch||(t.hooks.bindEvents.push((function(e,n){var t=e.getOptions();t.zoom.interactive&&t.zoom.enableTouch&&(n[0].addEventListener("pinchstart",p.start,!1),n[0].addEventListener("pinchdrag",p.drag,!1),n[0].addEventListener("pinchend",p.end,!1)),t.pan.interactive&&t.pan.enableTouch&&(n[0].addEventListener("panstart",d.start,!1),n[0].addEventListener("pandrag",d.drag,!1),n[0].addEventListener("panend",d.end,!1)),t.recenter.interactive&&t.recenter.enableTouch&&n[0].addEventListener("doubletap",h.recenterPlot,!1)})),t.hooks.shutdown.push((function(e,n){n[0].removeEventListener("panstart",d.start),n[0].removeEventListener("pandrag",d.drag),n[0].removeEventListener("panend",d.end),n[0].removeEventListener("pinchstart",p.start),n[0].removeEventListener("pinchdrag",p.drag),n[0].removeEventListener("pinchend",p.end),n[0].removeEventListener("doubletap",h.recenterPlot)})))}function i(e){return!e.touchedAxis||0===e.touchedAxis.length}function a(e,n,t,i){var a,o=s(e,n);switch(i.navigationConstraint){case"unconstrained":i.touchedAxis=null,t.prevTapPosition={x:t.prevPanPosition.x,y:t.prevPanPosition.y},t.prevPanPosition={x:o.x,y:o.y};break;case"axisConstrained":a=i.touchedAxis[0].direction,i.currentTouchedAxis=a,t.prevTapPosition[a]=t.prevPanPosition[a],t.prevPanPosition[a]=o[a]}}function o(e){var n,t,i,a,o=e.detail.touches[0],r=e.detail.touches[1];return n=o.pageX,t=o.pageY,i=r.pageX,a=r.pageY,Math.sqrt((n-i)*(n-i)+(t-a)*(t-a))}function r(e,n,t,i){var a=s(e,n);switch(i.navigationConstraint){case"unconstrained":t.prevPanPosition.x=a.x,t.prevPanPosition.y=a.y;break;case"axisConstrained":t.prevPanPosition[i.currentTouchedAxis]=a[i.currentTouchedAxis]}}function c(e,n,t){var i=s(e,n);return{x:i.x-t.prevPanPosition.x,y:i.y-t.prevPanPosition.y}}function s(e,n){return"pinch"===n?{x:(e.detail.touches[0].pageX+e.detail.touches[1].pageX)/2,y:(e.detail.touches[0].pageY+e.detail.touches[1].pageY)/2}:{x:e.detail.touches[0].pageX,y:e.detail.touches[0].pageY}}e.plot.plugins.push({init:function(e){e.hooks.processOptions.push(t)},options:{zoom:{enableTouch:!1},pan:{enableTouch:!1,touchMode:"manual"},recenter:{enableTouch:!0}},name:"navigateTouch",version:"0.3"})}(jQuery);