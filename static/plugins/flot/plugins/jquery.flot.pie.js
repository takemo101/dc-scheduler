!function(e){var i={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,shadow:{left:5,top:15,alpha:.02},offset:{top:0,left:"auto"},stroke:{color:"#fff",width:1},label:{show:"auto",formatter:function(e,i){return"<div style='font-size:x-small;text-align:center;padding:2px;color:"+i.color+";'>"+e+"<br/>"+Math.round(i.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:.5}}}};e.plot.plugins.push({init:function(i){var s=null,t=null,r=null,a=null,l=null,n=null,o=!1,p=null,h=[];function u(i,a,l){o||(o=!0,s=i.getCanvas(),t=e(s).parent(),r=i.getOptions(),i.setData(function(i){var s,t,a=0,l=0,n=0,o=r.series.pie.combine.color,p=[];for(s=0;s<i.length;++s)t=i[s].data,e.isArray(t)&&1===t.length&&(t=t[0]),e.isArray(t)?!isNaN(parseFloat(t[1]))&&isFinite(t[1])?t[1]=+t[1]:t[1]=0:t=!isNaN(parseFloat(t))&&isFinite(t)?[1,+t]:[1,0],i[s].data=[t];for(s=0;s<i.length;++s)a+=i[s].data[0][1];for(s=0;s<i.length;++s)(t=i[s].data[0][1])/a<=r.series.pie.combine.threshold&&(l+=t,n++,o||(o=i[s].color));for(s=0;s<i.length;++s)t=i[s].data[0][1],(n<2||t/a>r.series.pie.combine.threshold)&&p.push(e.extend(i[s],{data:[[1,t]],color:i[s].color,label:i[s].label,angle:t*Math.PI*2/a,percent:t/(a/100)}));n>1&&p.push({data:[[1,l]],color:o,label:r.series.pie.combine.label,angle:l*Math.PI*2/a,percent:l/(a/100)});return p}(i.getData())))}function c(i,s){if(t){var h=i.getPlaceholder().width(),u=i.getPlaceholder().height(),c=t.children().filter(".legend").children().width()||0;p=s,o=!1,a=Math.min(h,u/r.series.pie.tilt)/2,n=u/2+r.series.pie.offset.top,l=h/2,"auto"===r.series.pie.offset.left?(r.legend.position.match("w")?l+=c/2:l-=c/2,l<a?l=a:l>h-a&&(l=h-a)):l+=r.series.pie.offset.left;var d=i.getData(),f=0;do{f>0&&(a*=.95),f+=1,b(),r.series.pie.tilt<=.8&&v()}while(!w()&&f<10);f>=10&&(b(),t.prepend("<div class='error'>Could not draw pie with labels contained inside canvas</div>")),i.setSeries&&i.insertLegend&&(i.setSeries(d),i.insertLegend())}function b(){p.clearRect(0,0,h,u),t.children().filter(".pieLabel, .pieLabelBackground").remove()}function v(){var e=r.series.pie.shadow.left,i=r.series.pie.shadow.top,s=r.series.pie.shadow.alpha,t=r.series.pie.radius>1?r.series.pie.radius:a*r.series.pie.radius;if(!(t>=h/2-e||t*r.series.pie.tilt>=u/2-i||t<=10)){p.save(),p.translate(e,i),p.globalAlpha=s,p.fillStyle="#000",p.translate(l,n),p.scale(1,r.series.pie.tilt);for(var o=1;o<=10;o++)p.beginPath(),p.arc(0,0,t,0,2*Math.PI,!1),p.fill(),t-=o;p.restore()}}function w(){var i,s=Math.PI*r.series.pie.startAngle,o=r.series.pie.radius>1?r.series.pie.radius:a*r.series.pie.radius;p.save(),p.translate(l,n),p.scale(1,r.series.pie.tilt),p.save();var c=s;for(i=0;i<d.length;++i)d[i].startAngle=c,f(d[i].angle,d[i].color,!0);if(p.restore(),r.series.pie.stroke.width>0){for(p.save(),p.lineWidth=r.series.pie.stroke.width,c=s,i=0;i<d.length;++i)f(d[i].angle,r.series.pie.stroke.color,!1);p.restore()}return g(p),p.restore(),!r.series.pie.label.show||function(){for(var i=s,o=r.series.pie.label.radius>1?r.series.pie.label.radius:a*r.series.pie.label.radius,p=0;p<d.length;++p){if(d[p].percent>=100*r.series.pie.label.threshold&&!c(d[p],i,p))return!1;i+=d[p].angle}return!0;function c(i,s,a){if(0===i.data[0][1])return!0;var p,c=r.legend.labelFormatter,g=r.series.pie.label.formatter;p=c?c(i.label,i):i.label,g&&(p=g(p,i));var d=(s+i.angle+s)/2,f=l+Math.round(Math.cos(d)*o),b=n+Math.round(Math.sin(d)*o)*r.series.pie.tilt,v="<span class='pieLabel' id='pieLabel"+a+"' style='position:absolute;top:"+b+"px;left:"+f+"px;'>"+p+"</span>";t.append(v);var w=t.children("#pieLabel"+a),k=b-w.height()/2,M=f-w.width()/2;if(w.css("top",k),w.css("left",M),0-k>0||0-M>0||u-(k+w.height())<0||h-(M+w.width())<0)return!1;if(0!==r.series.pie.label.background.opacity){var m=r.series.pie.label.background.color;null==m&&(m=i.color);var P="top:"+k+"px;left:"+M+"px;";e("<div class='pieLabelBackground' style='position:absolute;width:"+w.width()+"px;height:"+w.height()+"px;"+P+"background-color:"+m+";'></div>").css("opacity",r.series.pie.label.background.opacity).insertBefore(w)}return!0}}();function f(e,i,s){e<=0||isNaN(e)||(s?p.fillStyle=i:(p.strokeStyle=i,p.lineJoin="round"),p.beginPath(),Math.abs(e-2*Math.PI)>1e-9&&p.moveTo(0,0),p.arc(0,0,o,c,c+e/2,!1),p.arc(0,0,o,c+e/2,c+e,!1),p.closePath(),c+=e,s?p.fill():p.stroke())}}}function g(e){if(r.series.pie.innerRadius>0){e.save();var i=r.series.pie.innerRadius>1?r.series.pie.innerRadius:a*r.series.pie.innerRadius;e.globalCompositeOperation="destination-out",e.beginPath(),e.fillStyle=r.series.pie.stroke.color,e.arc(0,0,i,0,2*Math.PI,!1),e.fill(),e.closePath(),e.restore(),e.save(),e.beginPath(),e.strokeStyle=r.series.pie.stroke.color,e.arc(0,0,i,0,2*Math.PI,!1),e.stroke(),e.closePath(),e.restore()}}function d(e,i){for(var s=!1,t=-1,r=e.length,a=r-1;++t<r;a=t)(e[t][1]<=i[1]&&i[1]<e[a][1]||e[a][1]<=i[1]&&i[1]<e[t][1])&&i[0]<(e[a][0]-e[t][0])*(i[1]-e[t][1])/(e[a][1]-e[t][1])+e[t][0]&&(s=!s);return s}function f(e){v("plothover",e)}function b(e){v("plotclick",e)}function v(e,s){var o=i.offset(),u=function(e,s){for(var t,r,o=i.getData(),h=i.getOptions(),u=h.series.pie.radius>1?h.series.pie.radius:a*h.series.pie.radius,c=0;c<o.length;++c){var g=o[c];if(g.pie.show){if(p.save(),p.beginPath(),p.moveTo(0,0),p.arc(0,0,u,g.startAngle,g.startAngle+g.angle/2,!1),p.arc(0,0,u,g.startAngle+g.angle/2,g.startAngle+g.angle,!1),p.closePath(),t=e-l,r=s-n,p.isPointInPath){if(p.isPointInPath(e-l,s-n))return p.restore(),{datapoint:[g.percent,g.data],dataIndex:0,series:g,seriesIndex:c}}else if(d([[0,0],[u*Math.cos(g.startAngle),u*Math.sin(g.startAngle)],[u*Math.cos(g.startAngle+g.angle/4),u*Math.sin(g.startAngle+g.angle/4)],[u*Math.cos(g.startAngle+g.angle/2),u*Math.sin(g.startAngle+g.angle/2)],[u*Math.cos(g.startAngle+g.angle/1.5),u*Math.sin(g.startAngle+g.angle/1.5)],[u*Math.cos(g.startAngle+g.angle),u*Math.sin(g.startAngle+g.angle)]],[t,r]))return p.restore(),{datapoint:[g.percent,g.data],dataIndex:0,series:g,seriesIndex:c};p.restore()}}return null}(parseInt(s.pageX-o.left),parseInt(s.pageY-o.top));if(r.grid.autoHighlight)for(var c=0;c<h.length;++c){var g=h[c];g.auto!==e||u&&g.series===u.series||w(g.series)}u&&function(e,s){var t=k(e);-1===t?(h.push({series:e,auto:s}),i.triggerRedrawOverlay()):s||(h[t].auto=!1)}(u.series,e);var f={pageX:s.pageX,pageY:s.pageY};t.trigger(e,[f,u])}function w(e){null==e&&(h=[],i.triggerRedrawOverlay());var s=k(e);-1!==s&&(h.splice(s,1),i.triggerRedrawOverlay())}function k(e){for(var i=0;i<h.length;++i){if(h[i].series===e)return i}return-1}i.hooks.processOptions.push((function(e,i){i.series.pie.show&&(i.grid.show=!1,"auto"===i.series.pie.label.show&&(i.legend.show?i.series.pie.label.show=!1:i.series.pie.label.show=!0),"auto"===i.series.pie.radius&&(i.series.pie.label.show?i.series.pie.radius=3/4:i.series.pie.radius=1),i.series.pie.tilt>1?i.series.pie.tilt=1:i.series.pie.tilt<0&&(i.series.pie.tilt=0))})),i.hooks.bindEvents.push((function(e,i){var s=e.getOptions();s.series.pie.show&&(s.grid.hoverable&&(i.unbind("mousemove").mousemove(f),i.bind("mouseleave",f)),s.grid.clickable&&i.unbind("click").click(b))})),i.hooks.shutdown.push((function(e,i){i.unbind("mousemove",f),i.unbind("mouseleave",f),i.unbind("click",b),h=[]})),i.hooks.processDatapoints.push((function(e,i,s,t){e.getOptions().series.pie.show&&u(e,i,s)})),i.hooks.drawOverlay.push((function(e,i){e.getOptions().series.pie.show&&function(e,i){var s=e.getOptions(),t=s.series.pie.radius>1?s.series.pie.radius:a*s.series.pie.radius;i.save(),i.translate(l,n),i.scale(1,s.series.pie.tilt);for(var r=0;r<h.length;++r)o(h[r].series);function o(e){e.angle<=0||isNaN(e.angle)||(i.fillStyle="rgba(255, 255, 255, "+s.series.pie.highlight.opacity+")",i.beginPath(),Math.abs(e.angle-2*Math.PI)>1e-9&&i.moveTo(0,0),i.arc(0,0,t,e.startAngle,e.startAngle+e.angle/2,!1),i.arc(0,0,t,e.startAngle+e.angle/2,e.startAngle+e.angle,!1),i.closePath(),i.fill())}g(i),i.restore()}(e,i)})),i.hooks.draw.push((function(e,i){e.getOptions().series.pie.show&&c(e,i)}))},options:i,name:"pie",version:"1.1"})}(jQuery);